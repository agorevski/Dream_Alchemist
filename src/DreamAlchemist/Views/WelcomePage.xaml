<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:DreamAlchemist.ViewModels"
             x:Class="DreamAlchemist.Views.WelcomePage"
             x:DataType="vm:WelcomeViewModel"
             Shell.NavBarIsVisible="False"
             BackgroundColor="{DynamicResource ThemeBackgroundPrimary}">

    <ScrollView>
        <VerticalStackLayout Padding="30" 
                           Spacing="40"
                           VerticalOptions="Center"
                           MinimumHeightRequest="600">
            
            <!-- Title Section -->
            <VerticalStackLayout Spacing="10" Margin="0,40,0,0">
                <Label Text="✨"
                       FontSize="60"
                       HorizontalOptions="Center"/>
                
                <Label Text="Dream Alchemist"
                       FontSize="42"
                       FontAttributes="Bold"
                       TextColor="{DynamicResource ThemePrimary}"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"/>
                
                <Label Text="A Surreal Trading Adventure"
                       FontSize="16"
                       TextColor="{DynamicResource ThemeTextTertiary}"
                       HorizontalOptions="Center"
                       Margin="0,5,0,0"/>
            </VerticalStackLayout>

            <!-- Decorative Frame -->
            <Frame BackgroundColor="{DynamicResource ThemeBackgroundSecondary}" 
                   CornerRadius="20" 
                   Padding="25"
                   BorderColor="{DynamicResource ThemePrimary}"
                   HasShadow="True"
                   Margin="0,20,0,0">
                <VerticalStackLayout Spacing="15">
                    <Label Text="🌙 Trade mysterious dream ingredients"
                           FontSize="14"
                           TextColor="{DynamicResource ThemeTextSecondary}"
                           Margin="0,0,0,5"/>
                    <Label Text="🧪 Synthesize powerful dreams in your lab"
                           FontSize="14"
                           TextColor="{DynamicResource ThemeTextSecondary}"
                           Margin="0,0,0,5"/>
                    <Label Text="🗺️ Explore surreal cities across the dreamscape"
                           FontSize="14"
                           TextColor="{DynamicResource ThemeTextSecondary}"
                           Margin="0,0,0,5"/>
                    <Label Text="📈 Build your reputation and unlock new tiers"
                           FontSize="14"
                           TextColor="{DynamicResource ThemeTextSecondary}"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Menu Buttons -->
            <VerticalStackLayout Spacing="20" Margin="0,20,0,0">
                <Button Text="✨ Start New Game"
                        Command="{Binding StartNewGameCommand}"
                        BackgroundColor="{DynamicResource ThemePrimary}"
                        TextColor="{DynamicResource ThemeTextPrimary}"
                        HeightRequest="70"
                        FontSize="20"
                        FontAttributes="Bold"
                        CornerRadius="15"/>
                
                <Button Text="📖 Continue Game"
                        Command="{Binding ContinueGameCommand}"
                        IsEnabled="{Binding HasExistingSave}"
                        BackgroundColor="{DynamicResource ThemeSecondary}"
                        TextColor="{DynamicResource ThemeTextPrimary}"
                        HeightRequest="70"
                        FontSize="20"
                        FontAttributes="Bold"
                        CornerRadius="15">
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" 
                                   Binding="{Binding HasExistingSave}" 
                                   Value="False">
                            <Setter Property="BackgroundColor" Value="{DynamicResource ThemeBorder}"/>
                            <Setter Property="TextColor" Value="{DynamicResource ThemeTextDisabled}"/>
                        </DataTrigger>
                    </Button.Triggers>
                </Button>
            </VerticalStackLayout>

            <!-- Save Status Message -->
            <Label Text="{Binding SaveStatusMessage}"
                   FontSize="13"
                   TextColor="{DynamicResource ThemeTextTertiary}"
                   HorizontalOptions="Center"
                   HorizontalTextAlignment="Center"
                   IsVisible="{Binding SaveStatusMessage, Converter={StaticResource StringIsNotNullOrEmptyConverter}}"
                   Margin="0,10,0,0"/>

            <!-- Error Message -->
            <Label Text="{Binding ErrorMessage}"
                   TextColor="{DynamicResource ThemeDanger}"
                   FontSize="14"
                   HorizontalOptions="Center"
                   HorizontalTextAlignment="Center"
                   IsVisible="{Binding ErrorMessage, Converter={StaticResource StringIsNotNullOrEmptyConverter}}"/>

            <!-- Loading Indicator -->
            <ActivityIndicator IsRunning="{Binding IsBusy}"
                              IsVisible="{Binding IsBusy}"
                              Color="{DynamicResource ThemePrimary}"
                              HeightRequest="40"
                              WidthRequest="40"/>

            <!-- DEBUG THEME SWITCHER -->
            <Frame BackgroundColor="{DynamicResource ThemeDanger}" 
                   Padding="15" 
                   Margin="0,30,0,0"
                   CornerRadius="12"
                   IsVisible="{Binding IsDebugMode}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="🎨 DEBUG: Theme Tester" 
                           FontAttributes="Bold" 
                           FontSize="16"
                           TextColor="{DynamicResource ThemeTextPrimary}"/>
                    
                    <BoxView HeightRequest="1" 
                             Color="{DynamicResource ThemeTextPrimary}" 
                             Opacity="0.3"/>
                    
                    <!-- Theme Picker -->
                    <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Color Theme:" 
                               VerticalOptions="Center"
                               TextColor="{DynamicResource ThemeTextPrimary}"/>
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding ThemeOptions}"
                                SelectedItem="{Binding SelectedTheme}"
                                TextColor="{DynamicResource ThemeTextPrimary}"
                                BackgroundColor="{DynamicResource ThemeBackgroundElevated}"
                                FontAttributes="Bold"/>
                    </Grid>
                    
                    <!-- Font Picker -->
                    <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Font Scheme:" 
                               VerticalOptions="Center"
                               TextColor="{DynamicResource ThemeTextPrimary}"/>
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding FontOptions}"
                                SelectedItem="{Binding SelectedFont}"
                                TextColor="{DynamicResource ThemeTextPrimary}"
                                BackgroundColor="{DynamicResource ThemeBackgroundElevated}"
                                FontAttributes="Bold"/>
                    </Grid>
                    
                    <!-- Live Preview -->
                    <Label Text="{Binding CurrentCombination, StringFormat='Current: {0}'}"
                           FontSize="12"
                           FontAttributes="Italic"
                           TextColor="{DynamicResource ThemeTextPrimary}"
                           HorizontalTextAlignment="Center"
                           Margin="0,5,0,0"/>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
